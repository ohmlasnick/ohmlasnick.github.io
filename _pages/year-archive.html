---
layout: archive
permalink: /year-archive/
title: "Coding projects"
author_profile: true
---

<head>

    <meta charset="utf-8" />
    <meta name="generator" content="R package animation 2.7">
    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/styles.css" />
    <link rel="stylesheet" href="css/scianimator.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/styles/github.min.css">

    <script src="/files/js/jquery-1.4.4.min.js"></script>
    <script src="/files/js/jquery.scianimator.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/highlight.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.3/languages/r.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

</head>

<p><strong>Toy sand simulator in Python</strong></p>

<p>Written for / inspired by Day #14 of <a href="https://adventofcode.com/2022/day/14">Advent of Code 2022.</a> Full code can be found on <a href="https://github.com/ohmlasnick/Sand_Simulator">GitHub.</a> The main simulator function uses custom classes <code>Map</code> and <code>Sand</code> to track the trajectory and location of each particle. You can also change the dimensions of the map and choose whether or not to include a platform.</p>

<pre>
def simulate():
	my_map = Map(dims=[10, 21], floor=True, platform=False)
	my_map.show_map()
	while True:
		# create new piece of sand
		sand = Sand(my_map)
		while (not sand.in_void()) and (not sand.is_settled()):
			sleep(0.01)
			if sand.free_below():
				sand.move('down')
			elif sand.free_left():
				sand.move('left-diag')
			elif sand.free_right():
				sand.move('right-diag')
			my_map.frame_counter += 1
			my_map.show_map()
		if sand.in_void():
			return sand.map.count_sand()
</pre>

<p>See the simulator in action (with a platform!):</p>

<video width="1000" class="center" controls autoplay>
    <source src="/files/simulation_with_platform.mov" type="video/mp4">
</video>

<p><strong>U.S. air pollution map in R</strong></p>

<p>Air pollution, particularly fine particulate matter (PM 2.5), is likely to have <a href="https://doi.org/10.3390/nano12152656">negative impacts on cardiovascular health</a> (Basith et al., 2022). PM 2.5 data at the county level are made publicly available by the CDC and are based on model predictions from the EPA's Downscaler model. Citation: Centers for Disease Control and Prevention. National Environmental Public Health Tracking Network. Web. Accessed: Feb 23, 2024. www.cdc.gov/ephtracking.</p>

<p>Below is a plot of the mean predicted PM 2.5 concentrations for each available county in the United States from 2016-2019.</p>

<center>
    <img id="ave_years" src="/files/pm25_all_years.png" width='864'/>
</center>

<p>And here's an animation of PM 2.5 concentrations by month (2016-2019), created using the saveHTML() function in R's SciAnimator library:</p>

<div class="scianimator"><div id="Rplot" style="display: inline-block;"></div></div>
    <script src="/files/js/Rplot.js"></script>

<p>Code section for how to create each frame of the animation (the whole script is available on <a href="https://github.com/ohmlasnick/Air_pollution_visual/tree/main">GitHub</a>):</p>

<pre>
create_frame <- function(start, end, month=FALSE) {
  
  year <- substr(start, 1, 4)
  if (month == TRUE){
    mo <- date_to_str(substr(start, 5, 6))
  } else {
    mo <- ''
  }
  
  air_pollution_timeline <- subset(air_pollution_df, start <= numeric_date & numeric_date < end)						  
  air_pollution_reduced <- select(air_pollution_timeline, c('fips', 'values'))
  average_pm25 <- aggregate(values ~ fips, air_pollution_reduced, mean)
  
  plot_usmap(regions = "counties", data = average_pm25) +
    scale_fill_gradientn(limits = range(0, 45), colours = palette) +
    labs(title = paste(mo, year), fill = "PM 2.5\n(\u00b5g/m\u00b3)") + 
    theme(panel.background=element_blank(), 
          legend.position = c(0.7, 1.0),
          legend.direction = "horizontal",
          legend.text = element_text(size=14),
          legend.title = element_text(size=20),
          plot.title = element_text(size=48,face="italic", hjust=0.2))
}
</pre>
